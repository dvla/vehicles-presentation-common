@(openingHour: Int, closingHour: Int, closingWarnPeriodMins: Int, dateService: uk.gov.dvla.vehicles.presentation.common.services.DateService)(implicit lang: Lang)

@import org.joda.time.DateTime
@import org.joda.time.DateTimeZone
@import uk.gov.dvla.vehicles.presentation.common.services.ServiceClosingWarningV2

@*
The service closing warning is only displayed when the current time is within a specified period.
The message changes when the time is less than 5 minutes. In this case the time remaining is displayed and will
be updated when the page is refreshed.
*@
@ServiceClosingWarningV2.warning(closingHour, closingWarnPeriodMins).map { timeRemaining =>
    @if(timeRemaining <= "00:05.00") {
        @* 5 min warning *@
        <div class="serviceClosingWarning">
            <p>@Messages(
                "global.serviceCloseWarning.fiveMinutes",
                openingHour,
                closingHour
            ) <span class="js-minutes-left">@{timeRemaining.dropWhile(_ != ':').drop(1).takeWhile(_ != '.')}</span>:
                <span class="js-seconds-left">@{timeRemaining.dropWhile(_ != '.').drop(1)}</span>@Messages("global.serviceCloseWarning.fiveMinutes.p2")</p>
        </div>
    } else {
        @if(timeRemaining <= s"00:${"%02d".format(closingWarnPeriodMins)}.00") {
            @* Normal service closing message *@
            <div class="serviceClosingWarning closing-warning">
                <p>
                @Messages("global.serviceCloseWarning",
                    new DateTime(dateService.now, DateTimeZone.forID("Europe/London")).toString(org.joda.time.format.DateTimeFormat.forPattern("HH:mm")),
                    closingHour
                )
                </p>
            </div>
        } else {
            @* No service closing message *@
        }
    }
}

    Service now closed. Service is available 08:00 to 18:00 Monday to Saturday.